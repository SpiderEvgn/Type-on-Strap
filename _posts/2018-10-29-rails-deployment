---
layout: post
title: 切到生产环境后 sidekiq 就失效了
date: 2018-10-08
tags: rails
---



讨论 rails 两种前端框架的部署方式：

1. asset pipeline




2. webpacker

本地开发环境的 Procfile:

rails:    rm -f /app/tmp/pids/server.pid && rails s -p 5000 -b 0.0.0.0
webpack:  bin/webpack-dev-server


本地通过启动 webpacker 的 开发服务器来实时 compile 前端并且提供服务，默认 webpacker 服务启动在 localhost:3035

而在生产环境用 nginx 伺服后不能依赖于 webpacker 服务，所以要提前 compile 前端文件，也不需要启动 webpacker 服务器。
所以生产环境的 Procfile 只需要：

rails:    rm -f /app/tmp/pids/server.pid && rails s -p 5000 -b 0.0.0.0

先做 compile 再重启服务：

NODE_ENV=development bundle exec rails assets:precompile